<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:ClimbTrack.ViewModels"
             x:Class="ClimbTrack.Views.AdminPage"
             x:DataType="viewmodels:AdminViewModel"
             Title="{Binding Title}">

    <ScrollView>
        <VerticalStackLayout Spacing="25" Padding="30">
            <Label 
                Text="Strumenti di Amministrazione"
                FontSize="24"
                FontAttributes="Bold"
                TextColor="{StaticResource TextPrimaryColor}"
                HorizontalOptions="Center" />
            <Border Stroke="{StaticResource BorderColor}"
        StrokeThickness="1"
        Padding="20"
        BackgroundColor="{StaticResource BackgroundColor}">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="10" />
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="15">
                    <Label 
            Text="Popolamento Database"
            FontSize="18"
            FontAttributes="Bold"
            TextColor="{StaticResource TextPrimaryColor}"
            />

                    <Label 
            Text="Questa operazione popolerà il database con dati iniziali. Utilizzare solo se il database è vuoto."
            FontSize="14"
            TextColor="{StaticResource TextSecondaryColor}"
            />

                    <Button 
            Text="Popola Database"
            Command="{Binding InitializeDatabaseCommand}"
            Style="{StaticResource PrimaryButtonStyle}"
            IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBoolConverter}}"
            />

                    <ActivityIndicator 
            IsRunning="{Binding IsBusy}"
            IsVisible="{Binding IsBusy}"
            Color="{StaticResource PrimaryColor}"
            HorizontalOptions="Center"
            />

                    <Label 
            Text="{Binding StatusMessage}"
            FontSize="14"
            TextColor="{Binding IsSuccess, Converter={StaticResource BoolToColorConverter}, ConverterParameter='Green|Red'}"
            IsVisible="{Binding StatusMessage, Converter={StaticResource StringNotNullOrEmptyBoolConverter}}"
            HorizontalOptions="Center"
            />
                </VerticalStackLayout>
            </Border>

            <!-- Sezione Database Info -->
            <Border Stroke="{StaticResource BorderColor}"
                    StrokeThickness="1"
                    Padding="20"
                    BackgroundColor="{StaticResource BackgroundColor}">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="10" />
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="15">
                    <Label 
            Text="Informazioni Database"
            FontSize="18"
            FontAttributes="Bold"
            TextColor="{StaticResource TextPrimaryColor}"
            />

                    <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto,Auto,Auto" RowSpacing="10" ColumnSpacing="15">
                        <Label Grid.Row="0" Grid.Column="0" Text="URL:" FontAttributes="Bold" TextColor="{StaticResource TextPrimaryColor}" />
                        <Label Grid.Row="0" Grid.Column="1" Text="https://climbtracknew-default-rtdb.firebasedatabase.com/" TextColor="{StaticResource TextSecondaryColor}" />

                        <Label Grid.Row="1" Grid.Column="0" Text="Stato:" FontAttributes="Bold" TextColor="{StaticResource TextPrimaryColor}" />
                        <Label Grid.Row="1" Grid.Column="1" Text="Connesso" TextColor="Green" />

                        <Label Grid.Row="2" Grid.Column="0" Text="Versione:" FontAttributes="Bold" TextColor="{StaticResource TextPrimaryColor}" />
                        <Label Grid.Row="2" Grid.Column="1" Text="1.0" TextColor="{StaticResource TextSecondaryColor}" />

                        <Label Grid.Row="3" Grid.Column="0" Text="Ultimo aggiornamento:" FontAttributes="Bold" TextColor="{StaticResource TextPrimaryColor}" />
                        <Label Grid.Row="3" Grid.Column="1" Text="{Binding LastUpdateTime}" TextColor="{StaticResource TextSecondaryColor}" />
                    </Grid>
                </VerticalStackLayout>
            </Border>

            <!-- Sezione Gestione Dati -->
            <Border Stroke="{StaticResource BorderColor}"
        StrokeThickness="1"
        Padding="20"
        BackgroundColor="{StaticResource BackgroundColor}">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="10" />
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="15">
                    <Label 
            Text="Gestione Dati"
            FontSize="18"
            FontAttributes="Bold"
            TextColor="{StaticResource TextPrimaryColor}"
            />

                    <Button 
            Text="Backup Database"
            Command="{Binding BackupDatabaseCommand}"
            BackgroundColor="{StaticResource AccentColor}"
            TextColor="White"
            CornerRadius="10"
            Margin="0,0,0,10"
            />

                    <Button 
            Text="Ripristina Database"
            Command="{Binding RestoreDatabaseCommand}"
            BackgroundColor="{StaticResource SecondaryColor}"
            TextColor="White"
            CornerRadius="10"
            Margin="0,0,0,10"
            />

                    <Button 
            Text="Cancella Dati di Test"
            Command="{Binding ClearTestDataCommand}"
            BackgroundColor="{StaticResource DangerColor}"
            TextColor="White"
            CornerRadius="10"
            />
                </VerticalStackLayout>
            </Border>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>