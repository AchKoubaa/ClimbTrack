<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:ClimbTrack.ViewModels"
             x:Class="ClimbTrack.Views.AdminPage"
             x:DataType="viewmodels:AdminViewModel"
             Title="{Binding Title}">

    <ScrollView>
        <VerticalStackLayout Spacing="25" Padding="30">
            <Label 
                Text="Strumenti di Amministrazione"
                FontSize="24"
                FontAttributes="Bold"
                TextColor="{StaticResource TextPrimaryColor}"
                HorizontalOptions="Center"
                AutomationProperties.Name="Titolo Strumenti di Amministrazione" />

            <Frame BorderColor="{StaticResource BorderColor}" 
                   Padding="20" 
                   CornerRadius="10"
                   BackgroundColor="{StaticResource BackgroundColor}">
                <VerticalStackLayout Spacing="15">
                    <Label 
                        Text="Popolamento Database"
                        FontSize="18"
                        FontAttributes="Bold"
                        TextColor="{StaticResource TextPrimaryColor}"
                        AutomationProperties.Name="Sezione Popolamento Database" />

                    <Label 
                        Text="Questa operazione popolerà il database con dati iniziali. Utilizzare solo se il database è vuoto."
                        FontSize="14"
                        TextColor="{StaticResource TextSecondaryColor}"
                        AutomationProperties.Name="Descrizione popolamento database" />

                    <Button 
                        Text="Popola Database"
                        Command="{Binding InitializeDatabaseCommand}"
                        Style="{StaticResource PrimaryButtonStyle}"
                        IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBoolConverter}}"
                        AutomationProperties.Name="Popola Database"
                        AutomationProperties.HelpText="Premi per popolare il database con dati iniziali" />

                    <ActivityIndicator 
                        IsRunning="{Binding IsBusy}"
                        IsVisible="{Binding IsBusy}"
                        Color="{StaticResource PrimaryColor}"
                        HorizontalOptions="Center"
                        AutomationProperties.Name="Indicatore di caricamento"
                        AutomationProperties.IsInAccessibleTree="{Binding IsBusy}" />

                    <Label 
                        Text="{Binding StatusMessage}"
                        FontSize="14"
                        TextColor="{Binding IsSuccess, Converter={StaticResource BoolToColorConverter}, ConverterParameter='Green|Red'}"
                        IsVisible="{Binding StatusMessage, Converter={StaticResource StringNotNullOrEmptyBoolConverter}}"
                        HorizontalOptions="Center"
                        AutomationProperties.Name="Messaggio di stato"
                        AutomationProperties.IsInAccessibleTree="{Binding StatusMessage, Converter={StaticResource StringNotNullOrEmptyBoolConverter}}" />
                </VerticalStackLayout>
            </Frame>

            <!-- Sezione Database Info -->
            <Frame BorderColor="{StaticResource BorderColor}" 
                   Padding="20" 
                   CornerRadius="10"
                   BackgroundColor="{StaticResource BackgroundColor}">
                <VerticalStackLayout Spacing="15">
                    <Label 
                        Text="Informazioni Database"
                        FontSize="18"
                        FontAttributes="Bold"
                        TextColor="{StaticResource TextPrimaryColor}"
                        AutomationProperties.Name="Sezione Informazioni Database" />

                    <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto,Auto,Auto" RowSpacing="10" ColumnSpacing="15">
                        <Label Grid.Row="0" Grid.Column="0" Text="URL:" FontAttributes="Bold" TextColor="{StaticResource TextPrimaryColor}" />
                        <Label Grid.Row="0" Grid.Column="1" Text="https://climbtracknew-default-rtdb.firebasedatabase.com/" TextColor="{StaticResource TextSecondaryColor}" />

                        <Label Grid.Row="1" Grid.Column="0" Text="Stato:" FontAttributes="Bold" TextColor="{StaticResource TextPrimaryColor}" />
                        <Label Grid.Row="1" Grid.Column="1" Text="Connesso" TextColor="Green" />

                        <Label Grid.Row="2" Grid.Column="0" Text="Versione:" FontAttributes="Bold" TextColor="{StaticResource TextPrimaryColor}" />
                        <Label Grid.Row="2" Grid.Column="1" Text="1.0" TextColor="{StaticResource TextSecondaryColor}" />

                        <Label Grid.Row="3" Grid.Column="0" Text="Ultimo aggiornamento:" FontAttributes="Bold" TextColor="{StaticResource TextPrimaryColor}" />
                        <Label Grid.Row="3" Grid.Column="1" Text="{Binding LastUpdateTime}" TextColor="{StaticResource TextSecondaryColor}" />
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- Sezione Gestione Dati -->
            <Frame BorderColor="{StaticResource BorderColor}" 
                   Padding="20" 
                   CornerRadius="10"
                   BackgroundColor="{StaticResource BackgroundColor}">
                <VerticalStackLayout Spacing="15">
                    <Label 
                        Text="Gestione Dati"
                        FontSize="18"
                        FontAttributes="Bold"
                        TextColor="{StaticResource TextPrimaryColor}"
                        AutomationProperties.Name="Sezione Gestione Dati" />

                    <Button 
                        Text="Backup Database"
                        Command="{Binding BackupDatabaseCommand}"
                        BackgroundColor="{StaticResource AccentColor}"
                        TextColor="White"
                        CornerRadius="10"
                        Margin="0,0,0,10"
                        AutomationProperties.Name="Backup Database"
                        AutomationProperties.HelpText="Premi per eseguire il backup del database" />

                    <Button 
                        Text="Ripristina Database"
                        Command="{Binding RestoreDatabaseCommand}"
                        BackgroundColor="{StaticResource SecondaryColor}"
                        TextColor="White"
                        CornerRadius="10"
                        Margin="0,0,0,10"
                        AutomationProperties.Name="Ripristina Database"
                        AutomationProperties.HelpText="Premi per ripristinare il database da un backup" />

                    <Button 
                        Text="Cancella Dati di Test"
                        Command="{Binding ClearTestDataCommand}"
                        BackgroundColor="{StaticResource DangerColor}"
                        TextColor="White"
                        CornerRadius="10"
                        AutomationProperties.Name="Cancella Dati di Test"
                        AutomationProperties.HelpText="Premi per cancellare tutti i dati di test dal database" />
                </VerticalStackLayout>
            </Frame>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>